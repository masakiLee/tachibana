import{_ as C,m as c,L as w,M as P,N as S,a as n,r as f,o as _,c as b,d as l,b as e,w as T,F as V,l as E,t as h,e as d,f as F,n as g,H as I,K as D,g as N,p as U,h as $}from"./index-ba425c64.js";import{P as q}from"./PageHeader-8552c2b8.js";import{c as a}from"./cart-cb3c8b81.js";import{S as y}from"./sweetalert2.all-fd72fbdd.js";const{VITE_APP_URL:A,VITE_APP_PATH:B}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"tachibanazushi",BASE_URL:"/tachibana/",MODE:"production",DEV:!1,PROD:!0},L={data(){return{likes:[]}},methods:{...c(a,["getCart"]),...c(a,["updateCartItem"]),...c(a,["deleteCartItem"]),...c(a,["useCoupon"]),...c(a,["addToCart"]),onSubmit(){const s=this.order;this.$http.post(`${A}/v2/api/${B}/order`,{data:s}).then(t=>{const v=t.data.orderId;this.$refs.form.resetForm(),v===void 0?y.fire({toast:!0,title:'<span style="color: #ff0000">需填收件人資訊</span>',icon:"error",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#000000"}):(this.$router.push(`/shoppingCartPay/${v}`),y.fire({toast:!0,title:"已送出訂單",icon:"success",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#F25C05"}),this.order.message="")}).catch(()=>{y.fire({toast:!0,title:'<span style="color: #ff0000">訂單送出失敗</span>',icon:"error",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#000000"})})},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需要正確的電話號碼"}},components:{PageHeader:q,VForm:w,VField:P,ErrorMessage:S},computed:{...n(a,["carts"]),...n(a,["total"]),...n(a,["final_total"]),...n(a,["copuon"]),...n(a,["hasCoupon"]),...n(a,["order"])},mounted(){this.getCart()},watch:{}},i=s=>(U("data-v-f763a81b"),s=s(),$(),s),j={class:"section-cart bg-darkTwo py-8"},H={class:"container"},M={class:"bg-dark p-4"},z=F('<ul class="step d-flex mb-4 border-bottom border-3 border-primary" data-v-f763a81b><li class="text-center py-2 flex-fill" data-v-f763a81b><i class="bi bi-check-square text-success" data-v-f763a81b></i> 購物車 </li><li class="text-center py-2 flex-fill bg-primary stepList" data-v-f763a81b><i class="bi bi-2-square" data-v-f763a81b></i> 結帳資訊 </li><li class="text-center py-2 flex-fill" data-v-f763a81b><i class="bi bi-3-square" data-v-f763a81b></i> 付款方式 </li></ul>',1),R={class:"row"},O={class:"col-lg-8 order-2 order-lg-1"},W=i(()=>e("p",{class:"py-2 border-bottom border-3 info"},[d(" 收件人資訊 "),e("span",{class:"marked"},"* 為必填項目")],-1)),K={class:"col-6"},G=i(()=>e("label",{for:"name",class:"form-label"},[d("姓名"),e("span",{class:"marked"},"＊")],-1)),J={class:"col-6"},Q=i(()=>e("label",{for:"tel",class:"form-label"},[d("電話"),e("span",{class:"marked"},"＊")],-1)),X={class:"col-12"},Y=i(()=>e("label",{for:"address",class:"form-label"},[d("地址"),e("span",{class:"marked"},"＊")],-1)),Z={class:"col-12"},ee=i(()=>e("label",{for:"email",class:"form-label"},[d("信箱"),e("span",{class:"marked"},"＊")],-1)),se={class:"col-12"},te=i(()=>e("label",{for:"message",class:"form-label"},"備註",-1)),oe={class:"col-lg-4 order-1 order-lg-2 mb-4 mb-lg-0"},ae=i(()=>e("p",{class:"cart border-bottom border-3 py-2"},"購買明細",-1)),le={class:"img bg-darkTwo d-flex justify-content-center align-items-center"},re=["src"],ie={class:"orderBody d-flex flex-column justify-content-around flex-fill"},ne={class:"ordertext d-flex justify-content-between ps-3"},de={class:"title"},ce={class:"num"},me={class:"d-flex justify-content-between ps-3 align-items-center"},ue={key:0,class:"px-1 bg-primary text-monospace useCoupon"},pe={class:"total ms-auto"},fe={class:"amount d-flex justify-content-between my-2"},_e=i(()=>e("span",null,"總金額：",-1)),be={class:"d-flex justify-content-end next"},he=i(()=>e("i",{class:"bi bi-arrow-right-square"},null,-1));function ge(s,t,v,ve,ye,m){const x=f("PageHeader"),u=f("VField"),p=f("ErrorMessage"),k=f("VForm");return _(),b(V,null,[l(x),e("section",j,[e("div",H,[e("div",M,[z,e("div",R,[e("div",O,[W,l(k,{ref:"form",onSubmit:m.onSubmit,class:"row g-4 text-white py-3"},{default:T(({errors:o})=>[e("div",K,[G,l(u,{id:"name",name:"姓名",type:"text",class:g(["form-control text-20",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.order.user.name,"onUpdate:modelValue":t[0]||(t[0]=r=>s.order.user.name=r)},null,8,["class","modelValue"]),l(p,{name:"姓名",class:"invalid-feedback"})]),e("div",J,[Q,l(u,{id:"tel",name:"電話",type:"text",class:g(["form-control text-20",{"is-invalid":o.電話}]),placeholder:"請輸入手機號碼",rules:m.isPhone,modelValue:s.order.user.tel,"onUpdate:modelValue":t[1]||(t[1]=r=>s.order.user.tel=r)},null,8,["class","rules","modelValue"]),l(p,{name:"電話",class:"invalid-feedback"})]),e("div",X,[Y,l(u,{id:"address",name:"地址",type:"text",class:g(["form-control text-20",{"is-invalid":o.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.order.user.address,"onUpdate:modelValue":t[2]||(t[2]=r=>s.order.user.address=r)},null,8,["class","modelValue"]),l(p,{name:"地址",class:"invalid-feedback"})]),e("div",Z,[ee,l(u,{id:"email",name:"email",type:"email",class:g(["form-control text-20",{"is-invalid":o.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.order.user.email,"onUpdate:modelValue":t[3]||(t[3]=r=>s.order.user.email=r)},null,8,["class","modelValue"]),l(p,{name:"email",class:"invalid-feedback"})]),e("div",se,[te,I(e("textarea",{name:"備註",id:"message",cols:"10",rows:"10",class:"w-100 ps-2 py-1","onUpdate:modelValue":t[4]||(t[4]=r=>s.order.message=r)},null,512),[[D,s.order.message]])])]),_:1},8,["onSubmit"])]),e("div",oe,[ae,(_(!0),b(V,null,E(s.carts,o=>(_(),b("div",{key:o.id,class:"d-flex py-4 border-bottom border-darkTwo border-3 justify-content-around"},[e("div",le,[e("img",{src:o.product.imageUrl,alt:"orderProImg",class:"cartProImg p-2"},null,8,re)]),e("div",ie,[e("div",ne,[e("p",de,h(o.product.title),1),e("p",ce,"× "+h(o.qty),1)]),e("div",me,[o.coupon?(_(),b("p",ue," 已使用優惠券 ")):N("",!0),e("p",pe," NT$ "+h(o.final_total.toLocaleString("zh-TW")),1)])])]))),128)),e("div",fe,[_e,e("span",null,"NT$ "+h(s.final_total.toLocaleString("zh-TW")),1)])])]),e("div",be,[e("button",{type:"submit",class:"btn btn-danger text-white btn-lg",onClick:t[5]||(t[5]=(...o)=>m.onSubmit&&m.onSubmit(...o))},[d(" 送出訂單 "),he])])])])])],64)}const we=C(L,[["render",ge],["__scopeId","data-v-f763a81b"]]);export{we as default};
