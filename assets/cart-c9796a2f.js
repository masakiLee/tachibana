import{i as c,j as n}from"./index-385571dd.js";import{S as o}from"./sweetalert2.all-6bb87d0f.js";const{VITE_APP_URL:s,VITE_APP_PATH:i}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"tachibanazushi",BASE_URL:"/tachibana/",MODE:"production",DEV:!1,PROD:!0},u=c("cart",{state:()=>({carts:{},total:0,final_total:0,copuon:{code:""},hasCoupon:!1,order:{user:{name:"",email:"",tel:"",address:""},message:""},orderId:""}),actions:{getCart(){n.get(`${s}/v2/api/${i}/cart`).then(t=>{this.carts=t.data.data.carts,this.total=t.data.data.total,this.final_total=t.data.data.final_total})},addToCart(t,e=1){const a={product_id:t,qty:e};n.post(`${s}/v2/api/${i}/cart`,{data:a}).then(()=>{this.getCart(),o.fire({toast:!0,title:"已加入購物車",icon:"success",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#F25C05"})}).catch(r=>{console.log(r)})},updateCartItem(t){const e={product_id:t.product.id,qty:t.qty};n.put(`${s}/v2/api/${i}/cart/${t.id}`,{data:e}).then(()=>{const a=t.product.title;this.getCart(),o.fire({toast:!0,title:`已修改<span style="color: #f25c05"> ${a} </span>數量`,icon:"success",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#000000"})})},deleteCartItem(t){const e=t.product.title;o.bindClickHandler(),o.mixin({icon:"warning",toast:!0,backdrop:!0,allowOutsideClick:!1,background:"#F2ECDD",color:"#000000",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"刪除",cancelButtonText:"取消",confirmButtonColor:"#ff0000",cancelButtonColor:"#1b1b1b",didOpen:a=>{a.addEventListener("mouseenter",o.stopTimer),a.addEventListener("mouseleave",o.resumeTimer)}}).fire({title:`是否要刪除<span style="color: #f25c05"> ${e} </span>？`}).then(a=>{a.isConfirmed&&n.delete(`${s}/v2/api/${i}/cart/${t.id}`).then(()=>{this.getCart(),o.fire({toast:!0,title:`已刪除<span style="color: #f25c05"> ${e} </span>`,icon:"success",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#000000"})})}),o.bindClickHandler()},useCoupon(){const t=this.copuon;n.post(`${s}/v2/api/${i}/coupon`,{data:t}).then(e=>{this.hasCoupon=e.data.success,this.final_total=e.data.data.final_total,o.fire({toast:!0,title:"已成功套用優惠券",icon:"success",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#F25C05"}),this.copuon.code=""}).catch(()=>{o.fire({toast:!0,title:'<span style="color: #ff0000">優惠代碼錯誤</span>',icon:"error",position:"top-end",showConfirmButton:!1,timer:1500,background:"#F2ECDD",color:"#000000"})})}}});export{u as c};
